{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"BERT Embeddings","provenance":[],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"d4e4b6db953f428991096fc57dacba9a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0f6d0c21b8424d16bd8a2529ee138ff8","IPY_MODEL_4d05f3c2f80b49cfa6d5a10ba2710f19","IPY_MODEL_29e3c74447bb40d2ab87623f482ed580"],"layout":"IPY_MODEL_fcd7b960664c44ce8478f3099f49cfb2"}},"0f6d0c21b8424d16bd8a2529ee138ff8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_60ad68f1f64b418899d7868297973cba","placeholder":"​","style":"IPY_MODEL_5c3c797ed05546e499a891c485bb4287","value":"Downloading: 100%"}},"4d05f3c2f80b49cfa6d5a10ba2710f19":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_303a54023eb74ec0a508d81508c0eac5","max":29,"min":0,"orientation":"horizontal","style":"IPY_MODEL_dc2175b1593a49da92556227f3973aab","value":29}},"29e3c74447bb40d2ab87623f482ed580":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5552d382f39e4fd18a55b954ea3ea9ac","placeholder":"​","style":"IPY_MODEL_c9555c2dbbd141958c0a39a0d4e02306","value":" 29.0/29.0 [00:00&lt;00:00, 716B/s]"}},"fcd7b960664c44ce8478f3099f49cfb2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"60ad68f1f64b418899d7868297973cba":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5c3c797ed05546e499a891c485bb4287":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"303a54023eb74ec0a508d81508c0eac5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dc2175b1593a49da92556227f3973aab":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5552d382f39e4fd18a55b954ea3ea9ac":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c9555c2dbbd141958c0a39a0d4e02306":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f850415225524c8fb1338291368201c5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_79574e5639d04ca2bd4c76d385df784f","IPY_MODEL_62ddebbcc047451d83c322416b18135c","IPY_MODEL_971d57b895d04cc4b11cae91ef098e3f"],"layout":"IPY_MODEL_c2adce62f8fe4944873627dc0765ab80"}},"79574e5639d04ca2bd4c76d385df784f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e6445de5a7b54629963a7f5f83df818d","placeholder":"​","style":"IPY_MODEL_3823bbb763a14e799e5d73e820120670","value":"Downloading: 100%"}},"62ddebbcc047451d83c322416b18135c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_285caebf590746ec905b1ba18453e1e0","max":570,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9820b61883dc444abcb52ca2c2c4708b","value":570}},"971d57b895d04cc4b11cae91ef098e3f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_85996da68169468a9d060b85b666748f","placeholder":"​","style":"IPY_MODEL_abb92c6206974b7fb71533f9b54f0c52","value":" 570/570 [00:00&lt;00:00, 16.1kB/s]"}},"c2adce62f8fe4944873627dc0765ab80":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e6445de5a7b54629963a7f5f83df818d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3823bbb763a14e799e5d73e820120670":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"285caebf590746ec905b1ba18453e1e0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9820b61883dc444abcb52ca2c2c4708b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"85996da68169468a9d060b85b666748f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"abb92c6206974b7fb71533f9b54f0c52":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f08ca606522f438190d6e34ab55af555":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_38b6996341844d39b278403ad5bd5151","IPY_MODEL_b6026007b1f643919751c505d61e0999","IPY_MODEL_cdc48c881810446281c98060e1cd25c1"],"layout":"IPY_MODEL_c0848c4a1b5d4ef687575e957326f07d"}},"38b6996341844d39b278403ad5bd5151":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d064b7e17b00407faafc8d7742f72c96","placeholder":"​","style":"IPY_MODEL_f2f8e80574e14174afab85c38f20c20c","value":"Downloading: 100%"}},"b6026007b1f643919751c505d61e0999":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ace0727cce6e494387b6930b67fb0ac0","max":213450,"min":0,"orientation":"horizontal","style":"IPY_MODEL_de14abf096b847f58c5f63c99e72c04d","value":213450}},"cdc48c881810446281c98060e1cd25c1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_586ca51475ad48578224c52a01a1a0a9","placeholder":"​","style":"IPY_MODEL_abc1cfe1c5e84300bcdb9804e71c26ff","value":" 208k/208k [00:00&lt;00:00, 909kB/s]"}},"c0848c4a1b5d4ef687575e957326f07d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d064b7e17b00407faafc8d7742f72c96":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f2f8e80574e14174afab85c38f20c20c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ace0727cce6e494387b6930b67fb0ac0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"de14abf096b847f58c5f63c99e72c04d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"586ca51475ad48578224c52a01a1a0a9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"abc1cfe1c5e84300bcdb9804e71c26ff":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3ebc6a0e4dc7462c97d82a841c342e36":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_76df8ac511b0448980d177a66339caa1","IPY_MODEL_4e860872ffc04d2c93d26737cdd59d1d","IPY_MODEL_27240a9bd0aa4e7888f08c9401f12670"],"layout":"IPY_MODEL_0c42dda258814cc18e0960b8a870efab"}},"76df8ac511b0448980d177a66339caa1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3b3397c6bc7d4f6689642cbfd96efcb8","placeholder":"​","style":"IPY_MODEL_69dd0fb3485640eab138d75e020f895a","value":"Downloading: 100%"}},"4e860872ffc04d2c93d26737cdd59d1d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_397e25fe887443cab5588764e9610ad1","max":435797,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cdc9ad60a9b84bfab1e895bbdcad68cf","value":435797}},"27240a9bd0aa4e7888f08c9401f12670":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2b2db636a4ff4efc9dd016456601fdbe","placeholder":"​","style":"IPY_MODEL_759a56d65cb84622a2d618d61449019c","value":" 426k/426k [00:00&lt;00:00, 860kB/s]"}},"0c42dda258814cc18e0960b8a870efab":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3b3397c6bc7d4f6689642cbfd96efcb8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"69dd0fb3485640eab138d75e020f895a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"397e25fe887443cab5588764e9610ad1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cdc9ad60a9b84bfab1e895bbdcad68cf":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2b2db636a4ff4efc9dd016456601fdbe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"759a56d65cb84622a2d618d61449019c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a5db404390bf49078e09e25807aead95":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_72ba2a17ad454cd38284461fd35aa3c2","IPY_MODEL_d2c60b2bad2c4e789aaceee61ccea2d4","IPY_MODEL_dae6123fbd2e41eb8cb1e67f105d0ef2"],"layout":"IPY_MODEL_19e539ab1f3a42f7a5886d6cb40c7988"}},"72ba2a17ad454cd38284461fd35aa3c2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a46d467c923e440c8c3fc1503743cada","placeholder":"​","style":"IPY_MODEL_3d459fecd2084972a30600ade5288778","value":"Downloading: 100%"}},"d2c60b2bad2c4e789aaceee61ccea2d4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_edb7f1aa53714158bd9fc34153462722","max":435779157,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0087202020574ea9a40e62425256225f","value":435779157}},"dae6123fbd2e41eb8cb1e67f105d0ef2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3cd297b2477143aeacb523aa55521600","placeholder":"​","style":"IPY_MODEL_9166987865eb4d0cbd4c4407bbd2a7e3","value":" 416M/416M [00:11&lt;00:00, 30.8MB/s]"}},"19e539ab1f3a42f7a5886d6cb40c7988":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a46d467c923e440c8c3fc1503743cada":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3d459fecd2084972a30600ade5288778":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"edb7f1aa53714158bd9fc34153462722":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0087202020574ea9a40e62425256225f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3cd297b2477143aeacb523aa55521600":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9166987865eb4d0cbd4c4407bbd2a7e3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["!pip install huggingface_hub\n","!pip install transformers -U"],"metadata":{"id":"TNqTdR7F4F74","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649524446883,"user_tz":240,"elapsed":24994,"user":{"displayName":"Grant Lau","userId":"14881312612135011787"}},"outputId":"aed5de6b-a61a-454d-e521-2cd92dff8577"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting huggingface_hub\n","  Downloading huggingface_hub-0.5.1-py3-none-any.whl (77 kB)\n","\u001b[?25l\r\u001b[K     |████▏                           | 10 kB 17.2 MB/s eta 0:00:01\r\u001b[K     |████████▍                       | 20 kB 24.0 MB/s eta 0:00:01\r\u001b[K     |████████████▋                   | 30 kB 14.9 MB/s eta 0:00:01\r\u001b[K     |████████████████▉               | 40 kB 8.0 MB/s eta 0:00:01\r\u001b[K     |█████████████████████           | 51 kB 6.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▎      | 61 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▌  | 71 kB 8.3 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 77 kB 3.0 MB/s \n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from huggingface_hub) (3.6.0)\n","Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from huggingface_hub) (3.13)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.7/dist-packages (from huggingface_hub) (4.63.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface_hub) (3.10.0.2)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from huggingface_hub) (2.23.0)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from huggingface_hub) (4.11.3)\n","Requirement already satisfied: packaging>=20.9 in /usr/local/lib/python3.7/dist-packages (from huggingface_hub) (21.3)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.9->huggingface_hub) (3.0.7)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->huggingface_hub) (3.7.0)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->huggingface_hub) (3.0.4)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->huggingface_hub) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->huggingface_hub) (1.24.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->huggingface_hub) (2021.10.8)\n","Installing collected packages: huggingface-hub\n","Successfully installed huggingface-hub-0.5.1\n","Collecting transformers\n","  Downloading transformers-4.18.0-py3-none-any.whl (4.0 MB)\n","\u001b[K     |████████████████████████████████| 4.0 MB 6.8 MB/s \n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.63.0)\n","Collecting sacremoses\n","  Downloading sacremoses-0.0.49-py3-none-any.whl (895 kB)\n","\u001b[K     |████████████████████████████████| 895 kB 36.6 MB/s \n","\u001b[?25hRequirement already satisfied: huggingface-hub<1.0,>=0.1.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (0.5.1)\n","Collecting pyyaml>=5.1\n","  Downloading PyYAML-6.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (596 kB)\n","\u001b[K     |████████████████████████████████| 596 kB 35.9 MB/s \n","\u001b[?25hRequirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.21.5)\n","Collecting tokenizers!=0.11.3,<0.13,>=0.11.1\n","  Downloading tokenizers-0.11.6-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (6.5 MB)\n","\u001b[K     |████████████████████████████████| 6.5 MB 13.9 MB/s \n","\u001b[?25hRequirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.11.3)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.6.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.1.0->transformers) (3.10.0.2)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.7)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.7.0)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2021.10.8)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.1.0)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (7.1.2)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.15.0)\n","Installing collected packages: pyyaml, tokenizers, sacremoses, transformers\n","  Attempting uninstall: pyyaml\n","    Found existing installation: PyYAML 3.13\n","    Uninstalling PyYAML-3.13:\n","      Successfully uninstalled PyYAML-3.13\n","Successfully installed pyyaml-6.0 sacremoses-0.0.49 tokenizers-0.11.6 transformers-4.18.0\n"]}]},{"cell_type":"code","source":["!pip install sentencepiece"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EoL3d_Zu4Xvw","executionInfo":{"status":"ok","timestamp":1649524453854,"user_tz":240,"elapsed":6978,"user":{"displayName":"Grant Lau","userId":"14881312612135011787"}},"outputId":"8f2d4d68-0bdf-4343-aaf5-4cf671698ba5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting sentencepiece\n","  Downloading sentencepiece-0.1.96-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.2 MB)\n","\u001b[?25l\r\u001b[K     |▎                               | 10 kB 20.8 MB/s eta 0:00:01\r\u001b[K     |▌                               | 20 kB 11.0 MB/s eta 0:00:01\r\u001b[K     |▉                               | 30 kB 8.4 MB/s eta 0:00:01\r\u001b[K     |█                               | 40 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█▍                              | 51 kB 5.5 MB/s eta 0:00:01\r\u001b[K     |█▋                              | 61 kB 6.5 MB/s eta 0:00:01\r\u001b[K     |██                              | 71 kB 7.0 MB/s eta 0:00:01\r\u001b[K     |██▏                             | 81 kB 6.2 MB/s eta 0:00:01\r\u001b[K     |██▍                             | 92 kB 6.9 MB/s eta 0:00:01\r\u001b[K     |██▊                             | 102 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███                             | 112 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███▎                            | 122 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███▌                            | 133 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███▉                            | 143 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████                            | 153 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████▎                           | 163 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████▋                           | 174 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████▉                           | 184 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████▏                          | 194 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████▍                          | 204 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████▊                          | 215 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████                          | 225 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████▏                         | 235 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████▌                         | 245 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████▊                         | 256 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████                         | 266 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████▎                        | 276 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████▋                        | 286 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████▉                        | 296 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████                        | 307 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████▍                       | 317 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████▋                       | 327 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████                       | 337 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████▏                      | 348 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████▌                      | 358 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████▊                      | 368 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████                      | 378 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████▎                     | 389 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████▌                     | 399 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████▉                     | 409 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████                     | 419 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████▍                    | 430 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████▋                    | 440 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████▉                    | 450 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████▏                   | 460 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████▍                   | 471 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████▊                   | 481 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████                   | 491 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████▎                  | 501 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████▌                  | 512 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████▊                  | 522 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████                  | 532 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████▎                 | 542 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████▋                 | 552 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████▉                 | 563 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████▏                | 573 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████▍                | 583 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████▋                | 593 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████                | 604 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████▏               | 614 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████▌               | 624 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████▊               | 634 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████               | 645 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████▎              | 655 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████▌              | 665 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████▉              | 675 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████              | 686 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████▍             | 696 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████▋             | 706 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████             | 716 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████▏            | 727 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████▍            | 737 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████▊            | 747 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████            | 757 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████▎           | 768 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████▌           | 778 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████▉           | 788 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████████           | 798 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████████▎          | 808 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████████▋          | 819 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████████▉          | 829 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████████▏         | 839 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████████▍         | 849 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████████▊         | 860 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████████         | 870 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████████▏        | 880 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████████▌        | 890 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████████▊        | 901 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████████        | 911 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████████▎       | 921 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████████▋       | 931 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████████▉       | 942 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████       | 952 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▍      | 962 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▋      | 972 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████      | 983 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▏     | 993 kB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▌     | 1.0 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▊     | 1.0 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████     | 1.0 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▎    | 1.0 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▌    | 1.0 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▉    | 1.1 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████    | 1.1 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▍   | 1.1 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▋   | 1.1 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▉   | 1.1 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▏  | 1.1 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▍  | 1.1 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▊  | 1.1 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████  | 1.1 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▎ | 1.1 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▌ | 1.2 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▊ | 1.2 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████ | 1.2 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▎| 1.2 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▋| 1.2 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▉| 1.2 MB 7.4 MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 1.2 MB 7.4 MB/s \n","\u001b[?25hInstalling collected packages: sentencepiece\n","Successfully installed sentencepiece-0.1.96\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":162,"referenced_widgets":["d4e4b6db953f428991096fc57dacba9a","0f6d0c21b8424d16bd8a2529ee138ff8","4d05f3c2f80b49cfa6d5a10ba2710f19","29e3c74447bb40d2ab87623f482ed580","fcd7b960664c44ce8478f3099f49cfb2","60ad68f1f64b418899d7868297973cba","5c3c797ed05546e499a891c485bb4287","303a54023eb74ec0a508d81508c0eac5","dc2175b1593a49da92556227f3973aab","5552d382f39e4fd18a55b954ea3ea9ac","c9555c2dbbd141958c0a39a0d4e02306","f850415225524c8fb1338291368201c5","79574e5639d04ca2bd4c76d385df784f","62ddebbcc047451d83c322416b18135c","971d57b895d04cc4b11cae91ef098e3f","c2adce62f8fe4944873627dc0765ab80","e6445de5a7b54629963a7f5f83df818d","3823bbb763a14e799e5d73e820120670","285caebf590746ec905b1ba18453e1e0","9820b61883dc444abcb52ca2c2c4708b","85996da68169468a9d060b85b666748f","abb92c6206974b7fb71533f9b54f0c52","f08ca606522f438190d6e34ab55af555","38b6996341844d39b278403ad5bd5151","b6026007b1f643919751c505d61e0999","cdc48c881810446281c98060e1cd25c1","c0848c4a1b5d4ef687575e957326f07d","d064b7e17b00407faafc8d7742f72c96","f2f8e80574e14174afab85c38f20c20c","ace0727cce6e494387b6930b67fb0ac0","de14abf096b847f58c5f63c99e72c04d","586ca51475ad48578224c52a01a1a0a9","abc1cfe1c5e84300bcdb9804e71c26ff","3ebc6a0e4dc7462c97d82a841c342e36","76df8ac511b0448980d177a66339caa1","4e860872ffc04d2c93d26737cdd59d1d","27240a9bd0aa4e7888f08c9401f12670","0c42dda258814cc18e0960b8a870efab","3b3397c6bc7d4f6689642cbfd96efcb8","69dd0fb3485640eab138d75e020f895a","397e25fe887443cab5588764e9610ad1","cdc9ad60a9b84bfab1e895bbdcad68cf","2b2db636a4ff4efc9dd016456601fdbe","759a56d65cb84622a2d618d61449019c"]},"id":"ySvMEllU3WGf","executionInfo":{"status":"ok","timestamp":1649524477282,"user_tz":240,"elapsed":21981,"user":{"displayName":"Grant Lau","userId":"14881312612135011787"}},"outputId":"850551e6-42d5-4da2-b6b7-439cb8b066cc"},"outputs":[{"output_type":"stream","name":"stderr","text":["Downloading: \"https://github.com/huggingface/pytorch-transformers/archive/main.zip\" to /root/.cache/torch/hub/main.zip\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/29.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d4e4b6db953f428991096fc57dacba9a"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/570 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f850415225524c8fb1338291368201c5"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/208k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f08ca606522f438190d6e34ab55af555"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/426k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3ebc6a0e4dc7462c97d82a841c342e36"}},"metadata":{}}],"source":["import torch\n","tokenizer = torch.hub.load('huggingface/pytorch-transformers', 'tokenizer', 'bert-base-cased')\n","\n","text_1 = \"Who was Jim Henson ?\"\n","text_2 = \"Jim Henson was a puppeteer\"\n","\n","# Tokenized input with special tokens around it (for BERT: [CLS] at the beginning and [SEP] at the end)\n","indexed_tokens = tokenizer.encode(text_1, text_2, add_special_tokens=True)"]},{"cell_type":"code","source":["segments_ids = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1]\n","\n","# Convert inputs to PyTorch tensors\n","segments_tensors = torch.tensor([segments_ids])\n","tokens_tensor = torch.tensor([indexed_tokens])\n","\n","bert_model = torch.hub.load('huggingface/pytorch-transformers', 'model', 'bert-base-cased')\n","\n","# with torch.no_grad():\n","#     encoded_layers, _ = bert_model(tokens_tensor, token_type_ids=segments_tensors)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":138,"referenced_widgets":["a5db404390bf49078e09e25807aead95","72ba2a17ad454cd38284461fd35aa3c2","d2c60b2bad2c4e789aaceee61ccea2d4","dae6123fbd2e41eb8cb1e67f105d0ef2","19e539ab1f3a42f7a5886d6cb40c7988","a46d467c923e440c8c3fc1503743cada","3d459fecd2084972a30600ade5288778","edb7f1aa53714158bd9fc34153462722","0087202020574ea9a40e62425256225f","3cd297b2477143aeacb523aa55521600","9166987865eb4d0cbd4c4407bbd2a7e3"]},"id":"9mfj8QOU4uGh","executionInfo":{"status":"ok","timestamp":1649524498268,"user_tz":240,"elapsed":15381,"user":{"displayName":"Grant Lau","userId":"14881312612135011787"}},"outputId":"8a02c2fd-d7d2-4cb0-c9c8-2d94cd0ca886"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Using cache found in /root/.cache/torch/hub/huggingface_pytorch-transformers_main\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/416M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a5db404390bf49078e09e25807aead95"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.predictions.bias', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight']\n","- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]}]},{"cell_type":"code","source":["import numpy as np                  # just in case\n","import pandas as pd                 # for extracting info\n","\n","import zipfile                      # for extracting photos from zip\n","from PIL import Image\n","from io import StringIO"],"metadata":{"id":"fxpvRarUBkbc"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["filepath = '/content/drive/MyDrive/YelpProject'\n","from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"h2-ag_dECU4s","executionInfo":{"status":"ok","timestamp":1649524518862,"user_tz":240,"elapsed":15466,"user":{"displayName":"Grant Lau","userId":"14881312612135011787"}},"outputId":"ee62c56f-5b06-4acf-b1c3-9782f40c1769"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["yelp_data = pd.read_json(f'{filepath}/foodEntriesWithReviews.json')"],"metadata":{"id":"NOVkYlljCW15"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["yelp_data.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"iTxEuUh6CbX6","executionInfo":{"status":"ok","timestamp":1649524524596,"user_tz":240,"elapsed":4,"user":{"displayName":"Grant Lau","userId":"14881312612135011787"}},"outputId":"160a3740-a6de-41f8-99e1-ad55f2202e3c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                 photo_id             business_id  \\\n","0  lZlulVObEzvCRhEmJAq-7A  2bncbx08BFs_IO6H-yWBxw   \n","1  XvO6tewa1-gH20GIUtvQTA  qUY04I5gDm5uyInd1mCizg   \n","2  qTOGkJNCgdcD1GalYG6bZw  SAP7Myf72pKvEc54Zl45vQ   \n","3  mwWW3GSErVOsSsR3GQ5CLg  VrlJifUE36-U_OaiipGexA   \n","4  GyGbnJ9cwCe80fGYr9ZdRA  BujhETG-6POYdsi_8I_MBg   \n","\n","                                       caption label  rating  \\\n","0                      Dim sum! Turnip pancake  food     3.0   \n","1  If you're into wicked good food\\, go ahead.  food     4.0   \n","2                                               food     3.5   \n","3                                               food     4.0   \n","4                                               food     3.5   \n","\n","                                             reviews  \n","0  [[Chinatown is flush with Chinese restaurants ...  \n","1  [[the cutest place ever! We were visiting and ...  \n","2  [[I started looking this place up on yelp and ...  \n","3  [[This place is pretty good I would say. It di...  \n","4  [[Really really hit the spot, dreaming of a go...  "],"text/html":["\n","  <div id=\"df-2110ad7d-2202-48ec-bc4c-05d111027b52\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>photo_id</th>\n","      <th>business_id</th>\n","      <th>caption</th>\n","      <th>label</th>\n","      <th>rating</th>\n","      <th>reviews</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>lZlulVObEzvCRhEmJAq-7A</td>\n","      <td>2bncbx08BFs_IO6H-yWBxw</td>\n","      <td>Dim sum! Turnip pancake</td>\n","      <td>food</td>\n","      <td>3.0</td>\n","      <td>[[Chinatown is flush with Chinese restaurants ...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>XvO6tewa1-gH20GIUtvQTA</td>\n","      <td>qUY04I5gDm5uyInd1mCizg</td>\n","      <td>If you're into wicked good food\\, go ahead.</td>\n","      <td>food</td>\n","      <td>4.0</td>\n","      <td>[[the cutest place ever! We were visiting and ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>qTOGkJNCgdcD1GalYG6bZw</td>\n","      <td>SAP7Myf72pKvEc54Zl45vQ</td>\n","      <td></td>\n","      <td>food</td>\n","      <td>3.5</td>\n","      <td>[[I started looking this place up on yelp and ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>mwWW3GSErVOsSsR3GQ5CLg</td>\n","      <td>VrlJifUE36-U_OaiipGexA</td>\n","      <td></td>\n","      <td>food</td>\n","      <td>4.0</td>\n","      <td>[[This place is pretty good I would say. It di...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>GyGbnJ9cwCe80fGYr9ZdRA</td>\n","      <td>BujhETG-6POYdsi_8I_MBg</td>\n","      <td></td>\n","      <td>food</td>\n","      <td>3.5</td>\n","      <td>[[Really really hit the spot, dreaming of a go...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2110ad7d-2202-48ec-bc4c-05d111027b52')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2110ad7d-2202-48ec-bc4c-05d111027b52 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2110ad7d-2202-48ec-bc4c-05d111027b52');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["print(yelp_data.iloc[0]['reviews']) "],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"E3ySXwXiCdAx","executionInfo":{"status":"ok","timestamp":1649524526744,"user_tz":240,"elapsed":139,"user":{"displayName":"Grant Lau","userId":"14881312612135011787"}},"outputId":"43320179-4f69-4f9d-8af2-da4f37be6287"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[['Chinatown is flush with Chinese restaurants densely packed on every block - most of which, in my opinion at least, have adapted strongly to the American...', 4], ['Wanted to find somewhere for a quick, reasonable meal when in Boston for the weekend.\\nAll the hotpot places over crowded, overpriced, noisy and two hour...', 4], ['Bustling joint in Chinatown, mainly Asian clientele so looked authentic, waitresses literally running from table to table. \\n\\nSteamed shrimp dumplings were...', 3]]\n"]}]},{"cell_type":"code","source":["reviews = []\n","ratings = []\n","for block_review in yelp_data['reviews']:\n","  if block_review:\n","    for review in block_review:\n","      reviews.append(review[0])\n","      ratings.append(review[1])"],"metadata":{"id":"8ECrc7LZCmWa"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["bert_embeddings = torch.empty((100,768))\n","i=0\n","for j in range(100):\n","  indexed_tokens = tokenizer.encode(reviews[j], add_special_tokens=True)\n","  tokens_tensor = torch.tensor([indexed_tokens])\n","  with torch.no_grad():\n","    bert = bert_model(tokens_tensor)[1]\n","  bert_embeddings[i] = bert\n","  i+=1\n"],"metadata":{"id":"S9A9mHQNC3sb"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for i in range(len(bert_embeddings)):\n","  bert_embeddings[i] = bert_embeddings[i].flatten()"],"metadata":{"id":"rxMe5YdCEQZ0"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["bert_embeddings[1]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rnBzIwQDU8PS","executionInfo":{"status":"ok","timestamp":1649524614894,"user_tz":240,"elapsed":205,"user":{"displayName":"Grant Lau","userId":"14881312612135011787"}},"outputId":"b5d8a1e2-f359-4f48-93f9-d4243272b0e6"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([-6.1454e-01,  3.7932e-01,  9.9957e-01, -9.8812e-01,  9.4461e-01,\n","         9.1567e-01,  9.7576e-01, -9.9461e-01, -9.5385e-01, -6.5390e-01,\n","         9.6174e-01,  9.9678e-01, -9.9834e-01, -9.9952e-01,  8.1752e-01,\n","        -9.5972e-01,  9.7617e-01, -4.7008e-01, -9.9987e-01, -8.2575e-01,\n","        -5.4835e-01, -9.9965e-01,  2.9708e-01,  9.7882e-01,  9.6389e-01,\n","         7.5487e-04,  9.6884e-01,  9.9987e-01,  8.4926e-01, -3.2826e-01,\n","         2.3219e-01, -9.8010e-01,  7.5856e-01, -9.9656e-01,  3.6585e-02,\n","         2.5307e-01,  7.0564e-01, -9.5067e-02,  6.9358e-01, -9.4861e-01,\n","        -6.3443e-01, -6.9135e-01,  7.1219e-01, -4.4495e-01,  8.8873e-01,\n","         1.6084e-01, -5.3648e-02, -1.1255e-01, -2.7152e-02,  9.9920e-01,\n","        -9.4144e-01,  9.7571e-01, -9.9397e-01,  9.7969e-01,  9.9069e-01,\n","         2.0275e-01,  9.9024e-01,  1.0873e-01, -9.9856e-01, -9.5203e-03,\n","         9.5207e-01,  2.7433e-01,  8.6624e-01, -1.0552e-01,  3.8623e-01,\n","        -2.8791e-01, -8.9932e-01,  1.0233e-01, -4.4867e-01,  8.6035e-02,\n","         1.5635e-01,  2.4229e-01,  9.7378e-01, -7.7271e-01,  2.9448e-02,\n","        -8.2483e-01,  2.6738e-01, -9.9955e-01,  8.9585e-01,  9.9987e-01,\n","         8.1784e-01, -9.9925e-01,  9.8944e-01, -2.0329e-01, -7.5593e-01,\n","         7.7060e-01, -9.9870e-01, -9.9854e-01,  9.5111e-03, -4.8111e-01,\n","         8.8624e-01, -9.6454e-01,  6.0127e-01, -8.6731e-01,  9.9993e-01,\n","        -9.0374e-01, -1.6119e-01,  3.0415e-01,  9.5520e-01, -8.1789e-01,\n","        -5.9432e-01,  9.1186e-01,  9.9865e-01, -9.9430e-01,  9.9805e-01,\n","         7.5195e-01, -8.9849e-01, -8.9790e-01,  8.4068e-01, -6.6770e-03,\n","         9.7613e-01, -9.7570e-01, -9.0279e-01, -7.9715e-02,  9.5165e-01,\n","        -8.3311e-01,  9.8099e-01,  8.4953e-01, -1.7088e-01,  9.9991e-01,\n","        -1.0780e-01,  9.5839e-01,  9.9695e-01,  8.6965e-01, -8.3265e-01,\n","        -1.5322e-01, -6.4257e-01,  8.7486e-01, -6.1925e-01, -1.2110e-01,\n","         7.3548e-01, -9.8044e-01, -9.9774e-01,  9.9847e-01, -2.8004e-01,\n","         9.9990e-01, -9.9781e-01,  9.9155e-01, -9.9973e-01, -8.6023e-01,\n","        -6.1829e-01, -9.8372e-02, -9.8278e-01, -1.9603e-01,  9.8288e-01,\n","        -7.2851e-02, -8.9219e-01, -8.4168e-01,  6.2834e-01, -8.6778e-01,\n","         4.8157e-01,  5.9577e-01, -9.3007e-01,  9.6265e-01,  9.9750e-01,\n","         9.4640e-01,  9.8672e-01,  8.0409e-02, -9.5049e-01,  9.1212e-01,\n","         9.5828e-01, -9.9897e-01,  9.2284e-01, -9.9245e-01,  9.9787e-01,\n","         9.3936e-01,  8.0575e-01, -9.9686e-01,  9.9977e-01, -6.7115e-01,\n","        -1.9680e-01,  2.3483e-01, -1.1936e-01, -9.9894e-01,  4.0133e-01,\n","         4.4749e-01,  6.2484e-01,  9.9848e-01, -9.8901e-01,  9.9856e-01,\n","         7.3153e-01,  2.3524e-01,  5.7799e-01,  9.9868e-01, -9.9097e-01,\n","        -9.5138e-01, -9.7123e-01,  1.8564e-01,  7.5796e-01,  7.7261e-01,\n","         2.0683e-01,  9.5961e-01,  9.9786e-01,  4.9863e-01, -9.9461e-01,\n","        -3.7183e-01,  9.5340e-01, -1.2375e-01,  9.9990e-01, -5.0599e-01,\n","        -9.9934e-01, -6.7653e-01,  8.9422e-01,  9.9323e-01, -1.5913e-01,\n","         9.7245e-01, -6.9650e-01, -2.8174e-01,  9.8371e-01, -9.5246e-01,\n","         9.9811e-01,  1.7497e-01,  7.9068e-01,  8.1252e-01,  9.8620e-01,\n","        -8.4573e-01, -1.2214e-01,  1.8700e-01, -7.2652e-01,  9.9965e-01,\n","        -9.9882e-01, -2.2111e-01,  3.6730e-01, -9.8473e-01, -9.9578e-01,\n","         9.6764e-01,  1.0331e-01, -7.7773e-01, -1.5002e-01,  6.5377e-01,\n","         1.7462e-01,  9.2445e-01,  9.7993e-01, -6.5569e-01, -7.4642e-01,\n","        -9.9930e-01, -9.9694e-01, -7.8857e-01, -9.5742e-01, -2.7315e-02,\n","         6.2432e-01, -2.7456e-01, -8.2648e-01, -9.9822e-01,  9.5079e-01,\n","         7.6431e-01, -8.8176e-01, -6.8960e-03, -7.6408e-01, -9.9810e-01,\n","         6.4110e-01, -9.0085e-01, -9.9656e-01,  9.9871e-01, -7.4370e-01,\n","         9.9524e-01,  9.5754e-01, -9.8730e-01,  7.4907e-01, -9.9870e-01,\n","        -1.3750e-01, -9.6669e-01,  4.4602e-01,  6.3677e-01, -6.9566e-01,\n","         2.0709e-02,  9.8793e-01, -9.4332e-01, -7.6687e-01,  7.9656e-01,\n","        -9.9971e-01,  8.7848e-01, -1.4576e-01,  9.9825e-01,  8.1079e-01,\n","         3.9816e-02,  9.6695e-01,  9.4084e-01, -9.6827e-01, -9.9941e-01,\n","         9.4251e-01,  8.2037e-01, -9.8866e-01, -1.3335e-01,  9.9982e-01,\n","        -9.9802e-01, -6.1119e-01, -9.2059e-01, -9.8720e-01, -9.9893e-01,\n","         2.9058e-01, -8.5881e-01,  2.7228e-01,  9.6937e-01,  3.5442e-01,\n","         2.2577e-01,  9.8956e-01,  9.7702e-01,  2.7508e-01, -2.2285e-01,\n","         4.7990e-03, -9.4778e-01, -8.5109e-01,  5.6054e-01,  1.5751e-01,\n","        -9.9989e-01,  9.9951e-01, -9.8977e-01,  9.5952e-01,  8.9956e-01,\n","        -9.9378e-01,  7.9880e-01,  1.4258e-01, -9.6688e-01, -5.6859e-02,\n","         9.9974e-01,  9.7301e-01,  5.3570e-03,  1.2782e-01,  9.1416e-01,\n","        -2.7074e-01,  6.8770e-01, -8.7506e-01, -6.6288e-01,  1.0428e-01,\n","        -8.8771e-01,  9.9060e-01,  7.7014e-01, -9.8281e-01,  9.9626e-01,\n","         8.4078e-02,  6.0400e-01, -8.7058e-01,  7.1482e-01,  9.7699e-01,\n","        -2.6986e-02, -4.9845e-01, -4.3628e-02, -2.2558e-01, -9.8396e-01,\n","        -2.7998e-02, -9.9737e-01, -4.9424e-01,  9.3778e-01,  9.7625e-01,\n","        -9.8997e-01,  9.7663e-01, -5.3870e-02,  9.1175e-01, -9.9797e-01,\n","         9.9994e-01, -9.9076e-01,  1.1154e-01,  8.3605e-01, -8.7555e-01,\n","        -4.5679e-01,  9.8026e-01,  9.8720e-01,  9.7623e-01, -9.7552e-01,\n","        -8.1193e-01,  8.4642e-01,  9.5323e-01, -9.7583e-01, -6.6016e-02,\n","        -9.9921e-01, -7.0651e-01,  9.8912e-01,  9.9644e-01,  7.6792e-02,\n","         2.9014e-02, -9.9811e-01,  9.5355e-01, -7.6977e-01, -9.1660e-01,\n","        -3.5785e-02, -7.9485e-01,  7.0505e-01,  9.9774e-01, -5.4443e-01,\n","         6.4459e-01,  1.6748e-01, -9.6821e-01,  8.6365e-01,  8.5880e-01,\n","         9.9956e-01, -9.5260e-01,  6.0572e-01,  9.7433e-01, -8.6383e-02,\n","        -6.9380e-01,  4.5950e-01,  9.9879e-01, -9.7465e-01, -8.3929e-02,\n","        -9.9882e-01, -1.3700e-01, -6.7488e-01, -1.6413e-01, -6.8760e-01,\n","         3.7404e-02, -8.5388e-01,  9.6600e-01,  5.5082e-01,  6.3645e-01,\n","        -4.9883e-01,  9.4322e-01, -4.6874e-01, -7.5556e-02, -3.3417e-01,\n","        -3.2028e-01,  4.7280e-01,  4.2801e-01,  9.7162e-01, -9.5943e-01,\n","         9.9918e-01, -2.0518e-01, -9.9988e-01, -9.9708e-01, -8.5120e-01,\n","        -9.9862e-01,  6.5624e-01, -9.8168e-01,  9.7629e-01,  9.2241e-01,\n","        -9.9821e-01, -9.9897e-01, -9.9030e-01, -9.6825e-01,  8.6801e-01,\n","         5.3965e-01,  7.4264e-02,  4.6471e-01,  3.3785e-02,  1.1832e-03,\n","        -3.5003e-01,  8.0067e-03, -9.1128e-01, -7.1611e-01, -9.9836e-01,\n","         8.5870e-01, -9.9987e-01, -7.5564e-01,  9.9703e-01, -9.9669e-01,\n","        -9.6750e-01, -8.7873e-01, -7.1139e-01, -8.3648e-01,  3.3514e-01,\n","         9.7300e-01, -1.6737e-01, -6.9004e-01, -9.9871e-01,  9.7521e-01,\n","        -8.0163e-01,  1.0208e-01, -8.5998e-01, -9.3362e-01,  9.9910e-01,\n","         7.8626e-01, -1.4791e-01, -5.0405e-02, -9.9759e-01,  9.8627e-01,\n","        -9.4558e-01, -9.4547e-01, -9.5793e-01,  5.5705e-02, -9.0991e-01,\n","        -9.9941e-01,  4.3930e-02,  9.9619e-01,  9.8105e-01,  9.5517e-01,\n","         1.6557e-01, -3.7181e-01, -9.3283e-01,  6.2223e-02, -9.9981e-01,\n","         8.2729e-01,  8.8298e-01, -9.7293e-01, -6.6472e-01,  9.8714e-01,\n","         9.4376e-01, -9.6195e-01, -9.8243e-01,  9.2632e-01,  5.4474e-01,\n","         9.1787e-01, -6.1844e-01, -3.1680e-01,  2.8953e-01,  1.8319e-02,\n","        -9.7562e-01, -8.6820e-01,  9.9231e-01, -9.9898e-01,  9.7036e-01,\n","         9.9491e-01,  9.9866e-01, -3.1947e-01,  1.2310e-01, -9.8442e-01,\n","        -9.4151e-01, -5.6642e-01,  3.0580e-01, -9.9978e-01,  9.9972e-01,\n","        -9.9990e-01,  4.9216e-01, -7.6762e-01,  8.6808e-01,  9.7703e-01,\n","        -3.9145e-01, -9.9972e-01, -9.9941e-01,  3.1615e-01,  2.2722e-02,\n","         9.7989e-01,  3.0331e-01,  1.3788e-01, -7.6582e-01, -4.6399e-01,\n","         9.9406e-01, -8.3294e-01, -8.3937e-01, -9.9792e-01,  9.9885e-01,\n","         6.3133e-01, -9.9641e-01,  9.9497e-01, -9.9868e-01,  8.7906e-01,\n","         9.5395e-01,  7.4539e-01,  9.5496e-01, -9.9864e-01,  9.9990e-01,\n","        -9.9941e-01,  9.9163e-01, -9.9992e-01, -9.9882e-01,  9.9954e-01,\n","        -9.7392e-01, -8.1204e-01, -9.9921e-01, -9.9817e-01,  6.9464e-01,\n","         9.3971e-02, -4.0416e-01,  9.7951e-01, -9.9941e-01, -9.9680e-01,\n","        -1.0898e-01, -9.3965e-01, -8.6446e-01,  9.9581e-01, -6.0849e-01,\n","         9.8077e-01, -1.7997e-01,  9.1766e-01,  2.1834e-01,  9.9792e-01,\n","         9.7159e-01, -7.9675e-01, -8.9469e-01, -9.8674e-01,  9.5966e-01,\n","        -6.3979e-01,  3.4251e-01,  9.1187e-01,  1.4943e-01, -7.5640e-01,\n","         3.3928e-01, -9.9433e-01,  3.8912e-01,  6.4754e-02,  8.9748e-01,\n","         9.2608e-01,  7.8529e-01, -1.7895e-01, -6.2311e-01, -2.9535e-01,\n","        -9.8214e-01,  5.0427e-01, -9.9858e-01,  9.4717e-01, -9.3294e-01,\n","        -1.9469e-02, -3.4051e-01,  1.4888e-01, -9.6013e-01,  9.9909e-01,\n","         9.9614e-01, -9.6738e-01, -1.3695e-02,  9.7355e-01, -7.8789e-01,\n","         9.6827e-01, -9.8621e-01,  7.7169e-02,  9.4517e-01, -6.7483e-01,\n","         9.6720e-01,  3.8875e-01,  1.7114e-02,  9.5483e-01, -9.8828e-01,\n","        -8.8359e-01, -5.2889e-01,  3.3651e-01, -1.3730e-01, -9.4732e-01,\n","        -6.1681e-02,  9.8850e-01, -3.5507e-01, -9.9937e-01,  9.3011e-01,\n","        -9.9843e-01, -1.0723e-01,  9.5312e-01, -2.2828e-01,  9.9971e-01,\n","        -7.9260e-01,  1.1191e-01,  2.7291e-01, -9.9945e-01, -9.9902e-01,\n","        -5.4691e-03, -1.3574e-01, -9.3345e-01,  9.9913e-01, -1.1022e-01,\n","         8.8397e-01, -9.9966e-01,  3.0566e-01,  9.9686e-01,  2.5581e-01,\n","         7.8123e-01, -8.3776e-01, -9.3148e-01, -9.6051e-01, -5.7877e-01,\n","        -3.6665e-02,  8.6134e-01, -9.8808e-01, -7.6238e-01, -9.0000e-01,\n","         9.9980e-01, -9.9539e-01, -8.1123e-01, -9.7107e-01,  6.1457e-01,\n","         7.9922e-01,  3.2717e-01,  2.0682e-01, -9.0022e-01,  9.3195e-01,\n","        -9.1205e-01,  9.9372e-01, -9.9020e-01, -9.9209e-01,  9.9942e-01,\n","         5.9346e-01, -9.9556e-01, -1.9376e-01, -3.0993e-01,  2.9251e-01,\n","         2.2870e-01,  7.1493e-01, -9.4304e-01, -1.7636e-01, -9.9278e-01,\n","         7.7159e-01, -8.7089e-01, -9.7696e-01, -2.9734e-01, -2.8186e-01,\n","        -9.6411e-01,  9.8447e-01,  9.5019e-01,  9.9981e-01, -9.9939e-01,\n","         7.0765e-01,  6.3337e-02,  9.9797e-01,  8.0501e-02, -6.0483e-01,\n","         9.1722e-01,  9.9907e-01, -6.9963e-01,  8.7854e-01, -1.1604e-01,\n","         9.2077e-02,  3.3588e-01, -6.1543e-01,  9.9765e-01, -9.3868e-01,\n","         1.8307e-01, -9.6131e-01, -9.9974e-01,  9.9975e-01,  4.4779e-03,\n","         9.7693e-01,  2.4469e-01,  7.8920e-01, -7.5862e-01,  9.7962e-01,\n","        -9.8060e-01, -8.0521e-01, -9.9991e-01,  1.8323e-01, -9.7592e-01,\n","        -9.7798e-01,  3.6397e-03,  9.7226e-01, -9.9895e-01, -9.8497e-01,\n","        -4.6535e-01, -9.9992e-01,  9.3933e-01, -9.9166e-01, -8.2423e-01,\n","        -9.7578e-01,  9.9781e-01, -2.2574e-01, -7.8273e-01,  9.5993e-01,\n","        -9.4576e-01,  9.4374e-01,  9.1671e-01, -4.1763e-01,  2.2592e-01,\n","         1.0883e-01, -7.9900e-01, -9.9508e-01, -9.2821e-01, -9.1655e-01,\n","         8.7562e-01, -9.7572e-01, -6.8179e-01,  9.9206e-01,  9.7367e-01,\n","        -9.9791e-01, -9.9167e-01,  9.9585e-01, -3.0353e-03,  9.8344e-01,\n","        -3.2102e-01, -9.9959e-01, -9.9972e-01,  1.1014e-01,  7.5657e-02,\n","         9.8845e-01, -3.2585e-01,  9.3452e-01,  5.9930e-01, -3.4742e-01,\n","         4.9358e-01, -6.5673e-01, -4.0224e-01, -6.1095e-01, -8.6957e-02,\n","         9.9987e-01, -8.2672e-01,  9.8201e-01])"]},"metadata":{},"execution_count":15}]},{"cell_type":"code","source":["bert_embeddings.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":165},"id":"1HFX5ueqfVTg","executionInfo":{"status":"error","timestamp":1649644769928,"user_tz":240,"elapsed":399,"user":{"displayName":"ECE324 Group","userId":"00541832639107211620"}},"outputId":"2b8e527a-29b1-42dd-857a-10d68c909859"},"execution_count":1,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-1-705ff0e433e5>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mbert_embeddings\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mNameError\u001b[0m: name 'bert_embeddings' is not defined"]}]},{"cell_type":"code","source":["class Feedforward(torch.nn.Module):\n","        def __init__(self, input_size, hidden_size):\n","            super(Feedforward, self).__init__()\n","            self.input_size = input_size\n","            self.hidden_size  = hidden_size\n","            self.fc1 = torch.nn.Linear(self.input_size, self.hidden_size)\n","            self.relu = torch.nn.ReLU()\n","            self.fc2 = torch.nn.Linear(self.hidden_size, 1)\n","            self.sigmoid = torch.nn.Sigmoid()\n","        def forward(self, x):\n","            hidden = self.fc1(x)\n","            relu = self.relu(hidden)\n","            output = self.fc2(relu)\n","            output = self.sigmoid(output)\n","            return output"],"metadata":{"id":"Lsfhdcw-EAlA"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model = Feedforward(768, 64)"],"metadata":{"id":"oBwNfM_XEFow"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["criterion = torch.nn.MSELoss()\n","optimizer = torch.optim.SGD(model.parameters(), lr = 0.01)"],"metadata":{"id":"swjOzlpnElRN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["ratings = torch.tensor(ratings[:100]).to(torch.float32)"],"metadata":{"id":"EtaN_nlcGBAC"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split\n","x_train, x_test, y_train, y_test = train_test_split(bert_embeddings, ratings, test_size=0.3, random_state=42)"],"metadata":{"id":"yWQVJEIxFbVG"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# model.eval()\n","# y_pred = model(x_test)\n","# before_train = criterion(y_pred.squeeze(), y_test)\n","# print('Test loss before training' , before_train.item())"],"metadata":{"id":"K00D9bCSE3p7"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# y_pred.squeeze()"],"metadata":{"id":"XxsAUQLqKh0y"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from tqdm import tqdm"],"metadata":{"id":"t4JsOmsSLkTD"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["epochs = 50\n","\n","for epoch in tqdm(range(int(epochs)),desc='Training Epochs'):\n","  outputs = model(x_train)\n","  loss = criterion(outputs.squeeze(), y_train)\n","  print(\"\\n\\n\")\n","  print(loss.item())\n","  optimizer.zero_grad() \n","  loss.backward() \n","\n","  optimizer.step()"],"metadata":{"id":"6B7gAjXwIqu6"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model2 = Feedforward(768, 64)"],"metadata":{"id":"8yCPEi4xQu8i"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["x_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2oFBNeF-Rqbr","executionInfo":{"status":"ok","timestamp":1649524041038,"user_tz":240,"elapsed":22,"user":{"displayName":"ECE324 Group","userId":"00541832639107211620"}},"outputId":"d0a76ef3-6261-4ea5-c868-8dbabfd6c8da"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[-0.6613,  0.4289,  0.9996,  ...,  0.9999, -0.7326,  0.9750],\n","        [-0.6035,  0.3827,  0.9992,  ...,  0.9998, -0.8698,  0.9777],\n","        [-0.5901,  0.3584,  0.9996,  ...,  0.9999, -0.8872,  0.9882],\n","        ...,\n","        [-0.4815,  0.4172,  0.9995,  ...,  0.9999, -0.6449,  0.9660],\n","        [-0.6060,  0.3896,  0.9995,  ...,  0.9998, -0.8491,  0.9833],\n","        [-0.6691,  0.3859,  0.9996,  ...,  0.9999, -0.8435,  0.9812]])"]},"metadata":{},"execution_count":25}]},{"cell_type":"code","source":["epochs = 50\n","x_train2 = torch.zeros(size=(100,768))\n","y_train2 = torch.zeros(size=(100,))\n","criterion2 = torch.nn.MSELoss()\n","optimizer2 = torch.optim.SGD(model2.parameters(), lr = 0.01)\n","for epoch in tqdm(range(int(epochs)),desc='Training Epochs'):\n","  outputs = model2(x_train2)\n","  loss = criterion2(outputs.squeeze(), y_train2)\n","  print(\"\\n\\n\")\n","  print(loss.item())\n","  optimizer2.zero_grad() \n","  loss.backward() \n","    \n","  optimizer.step() "],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QBPYxPZzQt13","executionInfo":{"status":"ok","timestamp":1649524041358,"user_tz":240,"elapsed":28,"user":{"displayName":"ECE324 Group","userId":"00541832639107211620"}},"outputId":"1dc8a99e-b314-4f4b-d1d2-72699c57796c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["\rTraining Epochs:   0%|          | 0/50 [00:00<?, ?it/s]"]},{"output_type":"stream","name":"stdout","text":["\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n"]},{"output_type":"stream","name":"stderr","text":["Training Epochs: 100%|██████████| 50/50 [00:00<00:00, 443.55it/s]"]},{"output_type":"stream","name":"stdout","text":["\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n","\n","\n","\n","0.28078076243400574\n"]},{"output_type":"stream","name":"stderr","text":["\n"]}]},{"cell_type":"code","source":["x_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"75lTZNGDI6Lf","executionInfo":{"status":"ok","timestamp":1649524041360,"user_tz":240,"elapsed":18,"user":{"displayName":"ECE324 Group","userId":"00541832639107211620"}},"outputId":"dda36f78-9fdb-4176-b1ed-d1b7c3135518"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[-0.6613,  0.4289,  0.9996,  ...,  0.9999, -0.7326,  0.9750],\n","        [-0.6035,  0.3827,  0.9992,  ...,  0.9998, -0.8698,  0.9777],\n","        [-0.5901,  0.3584,  0.9996,  ...,  0.9999, -0.8872,  0.9882],\n","        ...,\n","        [-0.4815,  0.4172,  0.9995,  ...,  0.9999, -0.6449,  0.9660],\n","        [-0.6060,  0.3896,  0.9995,  ...,  0.9998, -0.8491,  0.9833],\n","        [-0.6691,  0.3859,  0.9996,  ...,  0.9999, -0.8435,  0.9812]])"]},"metadata":{},"execution_count":27}]}]}